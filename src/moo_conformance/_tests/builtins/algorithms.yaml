name: algorithms
description: Cryptographic and encoding algorithm builtins (base64, hashing, HMAC, salting, crypt)

requires:
  builtins: [encode_base64, decode_base64, string_hash, binary_hash, value_hash, string_hmac, binary_hmac, value_hmac, salt, crypt]

tests:
  # Base64 Encoding
  - name: encode_base64_empty
    code: 'encode_base64("")'
    expect:
      value: ""

  - name: encode_base64_one_char
    code: 'encode_base64("a")'
    expect:
      value: "YQ=="

  - name: encode_base64_two_char
    code: 'encode_base64("aa")'
    expect:
      value: "YWE="

  - name: encode_base64_three_char
    code: 'encode_base64("aaa")'
    expect:
      value: "YWFh"

  - name: encode_base64_binary_ff
    code: 'encode_base64("~FF")'
    expect:
      value: "/w=="

  - name: encode_base64_binary_fb
    code: 'encode_base64("~FB")'
    expect:
      value: "+w=="

  # URL-safe Base64
  - name: encode_base64_url_safe_empty
    code: 'encode_base64("", 1)'
    expect:
      value: ""

  - name: encode_base64_url_safe_one_char
    code: 'encode_base64("a", 1)'
    expect:
      value: "YQ"

  - name: encode_base64_url_safe_binary_ff
    code: 'encode_base64("~FF", 1)'
    expect:
      value: "_w"

  - name: encode_base64_url_safe_binary_fb
    code: 'encode_base64("~FB", 1)'
    expect:
      value: "-w"

  - name: encode_base64_binary_string_foobar
    code: 'encode_base64("~66~6f~6f~62~61~72")'
    expect:
      value: "Zm9vYmFy"

  - name: encode_base64_bad_binary_string
    code: 'encode_base64("~00~#!~00")'
    expect:
      error: E_INVARG

  - name: encode_base64_length_one_char
    code: 'length(encode_base64("a"))'
    expect:
      value: 4

  - name: encode_base64_url_safe_length_one_char
    code: 'length(encode_base64("a", 1))'
    expect:
      value: 2
  - name: encode_base64_length_two_char
    code: 'length(encode_base64("aa"))'
    expect:
      value: 4

  - name: encode_base64_length_three_char
    code: 'length(encode_base64("aaa"))'
    expect:
      value: 4

  - name: encode_base64_url_safe_length_two_char
    code: 'length(encode_base64("aa", 1))'
    expect:
      value: 3

  - name: encode_base64_url_safe_length_three_char
    code: 'length(encode_base64("aaa", 1))'
    expect:
      value: 4

  - name: encode_base64_long_binary_with_nulls
    code: 'encode_base64("123456789~00123456789~00123456789~00")'
    expect:
      value: "MTIzNDU2Nzg5ADEyMzQ1Njc4OQAxMjM0NTY3ODkA"

  - name: encode_base64_url_safe_two_char
    code: 'encode_base64("aa", 1)'
    expect:
      value: "YWE"

  - name: encode_base64_long_binary_blob
    code: "encode_base64(\"~A7~CED~8E~D2L~16a~F6~F2~01UZ2~BC~B0)~EC~02~86v~CD~9B~05~E66~F3.vx<~F0~D1E@~C7~DA~F3~C7~C0~AAC~1E~D2~D0~03]!~F7~0C~C9~19~F0~82gv~E4~19:~02~F0~7E~F8~BE~CCj'F~C2~C3~B8~1C~91~1F~7E~F7~F5P~D9~0E~D8~D6~89~DA~86~B5~95~E0f~0CJ~92~01+~8A~AE.~7F;~88\")"
    expect:
      value: "p85EjtJMFmH28gFVWjK8sCnsAoZ2zZsF5jbzLnZ4PPDRRUDH2vPHwKpDHtLQA10h9wzJGfCCZ3bkGToC8H74vsxqJ0bCw7gckR9+9/VQ2Q7Y1onahrWV4GYMSpIBK4quLn87iA=="

  - name: encode_base64_url_safe_long_binary_blob
    code: "encode_base64(\"~A7~CED~8E~D2L~16a~F6~F2~01UZ2~BC~B0)~EC~02~86v~CD~9B~05~E66~F3.vx<~F0~D1E@~C7~DA~F3~C7~C0~AAC~1E~D2~D0~03]!~F7~0C~C9~19~F0~82gv~E4~19:~02~F0~7E~F8~BE~CCj'F~C2~C3~B8~1C~91~1F~7E~F7~F5P~D9~0E~D8~D6~89~DA~86~B5~95~E0f~0CJ~92~01+~8A~AE.~7F;~88\", 1)"
    expect:
      value: "p85EjtJMFmH28gFVWjK8sCnsAoZ2zZsF5jbzLnZ4PPDRRUDH2vPHwKpDHtLQA10h9wzJGfCCZ3bkGToC8H74vsxqJ0bCw7gckR9-9_VQ2Q7Y1onahrWV4GYMSpIBK4quLn87iA"

  - name: encode_base64_url_safe_bad_binary
    code: 'encode_base64("~00~#!~00", 1)'
    expect:
      error: E_INVARG

  - name: encode_base64_url_safe_foobar_binary
    code: 'encode_base64("~66~6f~6f~62~61~72", 1)'
    expect:
      value: "Zm9vYmFy"


  # Base64 Decoding
  - name: decode_base64_one_char
    code: 'decode_base64("YQ==")'
    expect:
      value: "a"

  - name: decode_base64_two_char
    code: 'decode_base64("YWE=")'
    expect:
      value: "aa"

  - name: decode_base64_three_char
    code: 'decode_base64("YWFh")'
    expect:
      value: "aaa"

  - name: decode_base64_binary_ff
    code: 'decode_base64("/w==")'
    expect:
      value: "~FF"

  - name: decode_base64_url_safe_one_char
    code: 'decode_base64("YQ", 1)'
    expect:
      value: "a"

  - name: decode_base64_url_safe_binary_ff
    code: 'decode_base64("_w", 1)'
    expect:
      value: "~FF"

  - name: decode_base64_bad_chars
    code: 'decode_base64("@@@@")'
    expect:
      error: E_INVARG

  - name: decode_base64_not_binary_string
    code: 'decode_base64("~5A~6D~39~76~59~6D~46~79")'
    expect:
      error: E_INVARG

  - name: decode_base64_padding_required_standard
    code: 'decode_base64("dGVzdA")'
    expect:
      error: E_INVARG

  - name: decode_base64_padding_optional_url_safe
    code: 'decode_base64("dGVzdA", 1)'
    expect:
      value: "test"

  - name: decode_base64_embedded_padding
    code: 'decode_base64("dGV=zdA=")'
    expect:
      error: E_INVARG

  - name: decode_base64_too_much_padding
    code: 'decode_base64("dGVzd===")'
    expect:
      error: E_INVARG

  - name: decode_base64_min_length
    code: 'decode_base64("A===")'
    expect:
      error: E_INVARG
  - name: decode_base64_binary_fb
    code: 'decode_base64("+w==")'
    expect:
      value: "~FB"

  - name: decode_base64_url_safe_binary_fb
    code: 'decode_base64("-w", 1)'
    expect:
      value: "~FB"

  - name: decode_base64_long_binary_with_nulls
    code: 'decode_base64("MTIzNDU2Nzg5ADEyMzQ1Njc4OQAxMjM0NTY3ODkA")'
    expect:
      value: "123456789~00123456789~00123456789~00"

  - name: decode_base64_url_safe_long_binary_with_nulls
    code: 'decode_base64("MTIzNDU2Nzg5ADEyMzQ1Njc4OQAxMjM0NTY3ODkA", 1)'
    expect:
      value: "123456789~00123456789~00123456789~00"

  - name: decode_base64_standard_one_padding_char
    code: 'decode_base64("dGVzdA=")'
    expect:
      error: E_INVARG

  - name: decode_base64_url_safe_one_padding_char
    code: 'decode_base64("dGVzdA=", 1)'
    expect:
      value: "test"

  - name: decode_base64_url_safe_single_char_error
    code: 'decode_base64("A", 1)'
    expect:
      error: E_INVARG

  - name: decode_base64_url_safe_bad_chars
    code: 'decode_base64("@@@@", 1)'
    expect:
      error: E_INVARG

  - name: decode_base64_length_one_char
    code: 'length(decode_base64("YQ=="))'
    expect:
      value: 1

  - name: decode_base64_length_two_char
    code: 'length(decode_base64("YWE="))'
    expect:
      value: 2

  - name: decode_base64_length_three_char
    code: 'length(decode_base64("YWFh"))'
    expect:
      value: 3

  - name: decode_base64_url_safe_length_one_char
    code: 'length(decode_base64("YQ", 1))'
    expect:
      value: 1

  - name: decode_base64_url_safe_length_two_char
    code: 'length(decode_base64("YWE", 1))'
    expect:
      value: 2

  - name: decode_base64_url_safe_length_three_char
    code: 'length(decode_base64("YWFh", 1))'
    expect:
      value: 3

  - name: decode_base64_url_safe_two_char
    code: 'decode_base64("YWE", 1)'
    expect:
      value: "aa"

  - name: decode_base64_url_safe_three_char
    code: 'decode_base64("YWFh", 1)'
    expect:
      value: "aaa"

  - name: decode_base64_standard_test_with_padding
    code: 'decode_base64("dGVzdA==")'
    expect:
      value: "test"

  - name: decode_base64_url_safe_test_with_full_padding
    code: 'decode_base64("dGVzdA==", 1)'
    expect:
      value: "test"

  - name: decode_base64_url_safe_not_binary_string
    code: 'decode_base64("~5A~6D~39~76~59~6D~46~79", 1)'
    expect:
      error: E_INVARG

  - name: decode_base64_url_safe_embedded_padding
    code: 'decode_base64("dGV=zdA=", 1)'
    expect:
      error: E_INVARG

  - name: decode_base64_url_safe_too_much_padding
    code: 'decode_base64("dGVzd===", 1)'
    expect:
      error: E_INVARG


  # Hashing - string_hash
  - name: string_hash_abc_md5
    code: 'string_hash("abc", "md5")'
    expect:
      value: "900150983CD24FB0D6963F7D28E17F72"

  - name: string_hash_abc_sha1
    code: 'string_hash("abc", "sha1")'
    expect:
      value: "A9993E364706816ABA3E25717850C26C9CD0D89D"

  - name: string_hash_abc_sha256
    code: 'string_hash("abc", "sha256")'
    expect:
      value: "BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD"

  - name: string_hash_abc_sha256_default
    code: 'string_hash("abc")'
    expect:
      value: "BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD"

  - name: string_hash_abc_ripemd160
    code: 'string_hash("abc", "ripemd160")'
    expect:
      value: "8EB208F7E05D987A9B044A8E98C6B087F15A0BFC"

  - name: string_hash_abc_sha224
    code: 'string_hash("abc", "sha224")'
    expect:
      value: "23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7"

  - name: string_hash_abc_sha384
    code: 'string_hash("abc", "sha384")'
    expect:
      value: "CB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1631A8B605A43FF5BED8086072BA1E7CC2358BAECA134C825A7"

  - name: string_hash_abc_sha512
    code: 'string_hash("abc", "sha512")'
    expect:
      value: "DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F"

  - name: string_hash_invalid_algorithm
    code: 'string_hash("abc", "bozo")'
    expect:
      error: E_INVARG

  # Hashing - binary_hash
  - name: binary_hash_abc_md5
    code: 'binary_hash("abc", "md5")'
    expect:
      value: "900150983CD24FB0D6963F7D28E17F72"

  - name: binary_hash_nulls_sha256
    code: 'binary_hash("~00~00~00~00~00", "sha256")'
    expect:
      value: "8855508AADE16EC573D21E6A485DFD0A7624085C1A14B5ECDD6485DE0C6839A4"

  - name: binary_hash_bad_binary_string
    code: 'binary_hash("~00~#!~00")'
    expect:
      error: E_INVARG

  # Hashing - value_hash
  - name: value_hash_empty_list_sha256
    code: 'value_hash({}, "sha256")'
    expect:
      value: "44136FA355B3678A1146AD16F7E8649E94FB4FC21FE77E8310C060F61CAAFF8A"

  - name: value_hash_empty_map_sha256
    code: 'value_hash([], "sha256")'
    expect:
      value: "4F53CDA18C2BAA0C0354BB5F9A3ECBE5ED12AB4D8E11BA873C2F11161202B945"

  # MD5 Test Vectors
  - name: md5_empty_string
    code: 'string_hash("", "md5")'
    expect:
      value: "D41D8CD98F00B204E9800998ECF8427E"

  - name: md5_single_a
    code: 'string_hash("a", "md5")'
    expect:
      value: "0CC175B9C0F1B6A831C399E269772661"

  - name: md5_message_digest
    code: 'string_hash("message digest", "md5")'
    expect:
      value: "F96B697D7CB7938D525A2F31AAF161D0"

  - name: md5_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "md5")'
    expect:
      value: "C3FCD3D76192E4007DFB496CCA67E13B"

  - name: md5_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "md5")'
    expect:
      value: "D174AB98D277D9F5A5611C2C9F419D9F"

  - name: md5_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "md5")'
    expect:
      value: "57EDF4A22BE3C955AC49DA2E2107B67A"

  - name: md5_38
    code: 'string_hash("38", "md5")'
    expect:
      value: "A5771BCE93E200C36F7CD9DFD0E5DEAA"

  # SHA1 Test Vectors
  - name: sha1_empty_string
    code: 'string_hash("", "sha1")'
    expect:
      value: "DA39A3EE5E6B4B0D3255BFEF95601890AFD80709"

  - name: sha1_single_a
    code: 'string_hash("a", "sha1")'
    expect:
      value: "86F7E437FAA5A7FCE15D1DDCB9EAEAEA377667B8"

  - name: sha1_message_digest
    code: 'string_hash("message digest", "sha1")'
    expect:
      value: "C12252CEDA8BE8994D5FA0290A47231C1D16AAE3"

  - name: sha1_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "sha1")'
    expect:
      value: "32D10C7B8CF96570CA04CE37F2A19D84240D3A89"

  - name: sha1_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha1")'
    expect:
      value: "761C457BF73B14D27E9E9265C46F4B4DDA11F940"

  - name: sha1_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha1")'
    expect:
      value: "50ABF5706A150990A08B2C5EA40FA0E585554732"

  - name: sha1_38
    code: 'string_hash("38", "sha1")'
    expect:
      value: "5B384CE32D8CDEF02BC3A139D4CAC0A22BB029E8"

  # SHA224 Test Vectors
  - name: sha224_empty_string
    code: 'string_hash("", "sha224")'
    expect:
      value: "D14A028C2A3A2BC9476102BB288234C415A2B01F828EA62AC5B3E42F"

  - name: sha224_single_a
    code: 'string_hash("a", "sha224")'
    expect:
      value: "ABD37534C7D9A2EFB9465DE931CD7055FFDB8879563AE98078D6D6D5"

  - name: sha224_message_digest
    code: 'string_hash("message digest", "sha224")'
    expect:
      value: "2CB21C83AE2F004DE7E81C3C7019CBCB65B71AB656B22D6D0C39B8EB"

  - name: sha224_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "sha224")'
    expect:
      value: "45A5F72C39C5CFF2522EB3429799E49E5F44B356EF926BCF390DCCC2"

  - name: sha224_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha224")'
    expect:
      value: "BFF72B4FCB7D75E5632900AC5F90D219E05E97A7BDE72E740DB393D9"

  - name: sha224_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha224")'
    expect:
      value: "B50AECBE4E9BB0B57BC5F3AE760A8E01DB24F203FB3CDCD13148046E"

  - name: sha224_38
    code: 'string_hash("38", "sha224")'
    expect:
      value: "4CFCA6DA32DA647198225460722B7EA1284F98C4B179E8DBAE3F93D5"

  - name: sha224_long_repeating
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "sha224")'
    expect:
      value: "75388B16512776CC5DBA5DA1FD890150B0C6455CB4F58B1952522525"

  # SHA256 Extended Test Vectors
  - name: sha256_empty_string
    code: 'string_hash("", "sha256")'
    expect:
      value: "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855"

  - name: sha256_single_a
    code: 'string_hash("a", "sha256")'
    expect:
      value: "CA978112CA1BBDCAFAC231B39A23DC4DA786EFF8147C4E72B9807785AFEE48BB"

  - name: sha256_message_digest
    code: 'string_hash("message digest", "sha256")'
    expect:
      value: "F7846F55CF23E14EEBEAB5B4E1550CAD5B509E3348FBC4EFA3A1413D393CB650"

  - name: sha256_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "sha256")'
    expect:
      value: "71C480DF93D6AE2F1EFAD1447C66C9525E316218CF51FC8D9ED832F2DAF18B73"

  - name: sha256_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha256")'
    expect:
      value: "DB4BFCBD4DA0CD85A60C3C37D3FBD8805C77F15FC6B1FDFE614EE0A7C8FDB4C0"

  - name: sha256_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha256")'
    expect:
      value: "F371BC4A311F2B009EEF952DD83CA80E2B60026C8E935592D0F9C308453C813E"

  - name: sha256_38
    code: 'string_hash("38", "sha256")'
    expect:
      value: "AEA92132C4CBEB263E6AC2BF6C183B5D81737F179F21EFDC5863739672F0F470"

  - name: sha256_long_repeating
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "sha256")'
    expect:
      value: "248D6A61D20638B8E5C026930C3E6039A33CE45964FF2167F6ECEDD419DB06C1"

  - name: sha256_very_long_repeating
    code: 'string_hash("abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "sha256")'
    expect:
      value: "CF5B16A778AF8380036CE59E7B0492370B249B11E8F07A51AFAC45037AFEE9D1"

  # SHA384 Extended Test Vectors
  - name: sha384_empty_string
    code: 'string_hash("", "sha384")'
    expect:
      value: "38B060A751AC96384CD9327EB1B1E36A21FDB71114BE07434C0CC7BF63F6E1DA274EDEBFE76F65FBD51AD2F14898B95B"

  - name: sha384_single_a
    code: 'string_hash("a", "sha384")'
    expect:
      value: "54A59B9F22B0B80880D8427E548B7C23ABD873486E1F035DCE9CD697E85175033CAA88E6D57BC35EFAE0B5AFD3145F31"

  - name: sha384_message_digest
    code: 'string_hash("message digest", "sha384")'
    expect:
      value: "473ED35167EC1F5D8E550368A3DB39BE54639F828868E9454C239FC8B52E3C61DBD0D8B4DE1390C256DCBB5D5FD99CD5"

  - name: sha384_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "sha384")'
    expect:
      value: "FEB67349DF3DB6F5924815D6C3DC133F091809213731FE5C7B5F4999E463479FF2877F5F2936FA63BB43784B12F3EBB4"

  - name: sha384_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha384")'
    expect:
      value: "1761336E3F7CBFE51DEB137F026F89E01A448E3B1FAFA64039C1464EE8732F11A5341A6F41E0C202294736ED64DB1A84"

  - name: sha384_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha384")'
    expect:
      value: "B12932B0627D1C060942F5447764155655BD4DA0C9AFA6DD9B9EF53129AF1B8FB0195996D2DE9CA0DF9D821FFEE67026"

  - name: sha384_38
    code: 'string_hash("38", "sha384")'
    expect:
      value: "C071D202AD950B6A04A5F15C24596A993AF8B212467958D570A3FFD4780060638E3A3D06637691D3012BD31122071B2C"

  - name: sha384_very_long_repeating
    code: 'string_hash("abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "sha384")'
    expect:
      value: "09330C33F71147E83D192FC782CD1B4753111B173B3B05D22FA08086E3B0F712FCC7C71A557E2DB966C3E9FA91746039"

  # SHA512 Extended Test Vectors
  - name: sha512_empty_string
    code: 'string_hash("", "sha512")'
    expect:
      value: "CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E"

  - name: sha512_single_a
    code: 'string_hash("a", "sha512")'
    expect:
      value: "1F40FC92DA241694750979EE6CF582F2D5D7D28E18335DE05ABC54D0560E0F5302860C652BF08D560252AA5E74210546F369FBBBCE8C12CFC7957B2652FE9A75"

  - name: sha512_message_digest
    code: 'string_hash("message digest", "sha512")'
    expect:
      value: "107DBF389D9E9F71A3A95F6C055B9251BC5268C2BE16D6C13492EA45B0199F3309E16455AB1E96118E8A905D5597B72038DDB372A89826046DE66687BB420E7C"

  - name: sha512_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "sha512")'
    expect:
      value: "4DBFF86CC2CA1BAE1E16468A05CB9881C97F1753BCE3619034898FAA1AABE429955A1BF8EC483D7421FE3C1646613A59ED5441FB0F321389F77F48A879C7B1F1"

  - name: sha512_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha512")'
    expect:
      value: "1E07BE23C26A86EA37EA810C8EC7809352515A970E9253C26F536CFC7A9996C45C8370583E0A78FA4A90041D71A4CEAB7423F19C71B9D5A3E01249F0BEBD5894"

  - name: sha512_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha512")'
    expect:
      value: "72EC1EF1124A45B047E8B7C75A932195135BB61DE24EC0D1914042246E0AEC3A2354E093D76F3048B456764346900CB130D2A4FD5DD16ABB5E30BCB850DEE843"

  - name: sha512_38
    code: 'string_hash("38", "sha512")'
    expect:
      value: "CAAE34A5E81031268BCDAF6F1D8C04D37B7F2C349AFB705B575966F63E2EBF0FD910C3B05160BA087AB7AF35D40B7C719C53CD8B947C96111F64105FD45CC1B2"

  - name: sha512_very_long_repeating
    code: 'string_hash("abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu", "sha512")'
    expect:
      value: "8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7FA17299AEADB6889018501D289E4900F7E4331B99DEC4B5433AC7D329EEB6DD26545E96E55B874BE909"

  - name: sha512_triple_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "sha512")'
    expect:
      value: "5338370F5655F4DA14572D4FB471539B201485ECFB3D3204048DC6B83E61FAB505BCBBD73E644A1A5D159A32A0889CF3C9591B69B26D31BE56C68838CE3CD63D"

  - name: sha512_very_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890", "sha512")'
    expect:
      value: "33F8901B053E4CC677D3CB4122D96AD9B96B13BF76194CF962488BB4DE4998A71455CB31582DB527ADF77A485B81CF5B722A5E8638EB6BE487400F3AEC006E7C"

  # RIPEMD160 Extended Test Vectors
  - name: ripemd160_empty_string
    code: 'string_hash("", "ripemd160")'
    expect:
      value: "9C1185A5C5E9FC54612808977EE8F548B2258D31"

  - name: ripemd160_single_a
    code: 'string_hash("a", "ripemd160")'
    expect:
      value: "0BDC9D2D256B3EE9DAAE347BE6F4DC835A467FFE"

  - name: ripemd160_alphabet
    code: 'string_hash("abcdefghijklmnopqrstuvwxyz", "ripemd160")'
    expect:
      value: "F71C27109C692C1B56BBDCEB5B9D2865B3708DBC"

  - name: ripemd160_message_digest
    code: 'string_hash("message digest", "ripemd160")'
    expect:
      value: "5D0689EF49D2FAE572B881B123A85FFA21595F36"

  - name: ripemd160_alphanumeric
    code: 'string_hash("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "ripemd160")'
    expect:
      value: "B0E20B6E3116640286ED3A87A5713079B21F5189"

  - name: ripemd160_long_digits
    code: 'string_hash("12345678901234567890123456789012345678901234567890123456789012345678901234567890", "ripemd160")'
    expect:
      value: "9B752E45573D4B39F4DBD3323CAB82BF63326BFB"

  - name: ripemd160_38
    code: 'string_hash("38", "ripemd160")'
    expect:
      value: "6B2D075B1CD34CD1C3E43A995F110C55649DAD0E"

  # string_hash - "abcdbcde..." extended vectors (missing algorithms)
  - name: string_hash_abcdbcde_md5
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "md5")'
    expect:
      value: "8215EF0796A20BCAAAE116D3876C664A"

  - name: string_hash_abcdbcde_ripemd160
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "ripemd160")'
    expect:
      value: "12A053384A9C0C88E405A06C27DCF49ADA62EB2B"

  - name: string_hash_abcdbcde_sha1
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "sha1")'
    expect:
      value: "84983E441C3BD26EBAAE4AA1F95129E5E54670F1"

  - name: string_hash_abcdbcde_sha384
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "sha384")'
    expect:
      value: "3391FDDDFC8DC7393707A65B1B4709397CF8B1D162AF05ABFE8F450DE5F36BC6B0455A8520BC4E6F5FE95B1FE3C8452B"

  - name: string_hash_abcdbcde_sha512
    code: 'string_hash("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", "sha512")'
    expect:
      value: "204A8FC6DDA82F0A0CED7BEB8E08A41657C16EF468B228A8279BE331A703C33596FD15C13B1B07F9AA1D3BEA57789CA031AD85C7A71DD70354EC631238CA3445"

  # binary_hash - nulls with additional algorithms
  - name: binary_hash_nulls_md5
    code: 'binary_hash("~00~00~00~00~00", "md5")'
    expect:
      value: "CA9C491AC66B2C62500882E93F3719A8"

  - name: binary_hash_nulls_ripemd160
    code: 'binary_hash("~00~00~00~00~00", "ripemd160")'
    expect:
      value: "585BD7ED566208944B1F2E13170CD4B66325B8EE"

  - name: binary_hash_nulls_sha1
    code: 'binary_hash("~00~00~00~00~00", "sha1")'
    expect:
      value: "A10909C2CDCAF5ADB7E6B092A4FABA558B62BD96"

  - name: binary_hash_nulls_sha224
    code: 'binary_hash("~00~00~00~00~00", "sha224")'
    expect:
      value: "0E61C65E55810439F418C959DD030C194B2FDAA2AE46B13B3732FF17"

  - name: binary_hash_nulls_sha384
    code: 'binary_hash("~00~00~00~00~00", "sha384")'
    expect:
      value: "8E8D9847B6BD198BB1980DB334659E96A1BF3DBB5C56368C6FABE6F6B561232790E3B40C1D4FB50A19C349B10BDC6950"

  - name: binary_hash_nulls_sha512
    code: 'binary_hash("~00~00~00~00~00", "sha512")'
    expect:
      value: "65FAA9D920E0E9CFF43FC3F30AB02BA2E8CF6F4643B58F7C1E64583FBEC8A268E677B0EC4D54406E748BECB53FDA210F5D4F39CF2A5014B1CA496B0805182649"

  # value_hash - empty map [] with additional algorithms
  - name: value_hash_empty_map_md5
    code: 'value_hash([], "md5")'
    expect:
      value: "D751713988987E9331980363E24189CE"

  - name: value_hash_empty_map_ripemd160
    code: 'value_hash([], "ripemd160")'
    expect:
      value: "2BDF48D04094F739353B0C92F25B8BDCF7BBB679"

  - name: value_hash_empty_map_sha1
    code: 'value_hash([], "sha1")'
    expect:
      value: "97D170E1550EEE4AFC0AF065B78CDA302A97674C"

  - name: value_hash_empty_map_sha224
    code: 'value_hash([], "sha224")'
    expect:
      value: "23F497F643E37257C3F7E54F049D8829C41103BB29BF8C0BA0D1DF0A"

  - name: value_hash_empty_map_sha384
    code: 'value_hash([], "sha384")'
    expect:
      value: "562109B054CB4428FC53607B107C0ACDF91DE434B990A0295F516EF2AAD79EFC902238944E76D42F21BCF710BFA4C554"

  - name: value_hash_empty_map_sha512
    code: 'value_hash([], "sha512")'
    expect:
      value: "B25B294CB4DEB69EA00A4C3CF3113904801B6015E5956BD019A8570B1FE1D6040E944EF3CDEE16D0A46503CA6E659A25F21CF9CEDDC13F352A3C98138C15D6AF"

  # value_hash - empty list {} with additional algorithms
  - name: value_hash_empty_list_md5
    code: 'value_hash({}, "md5")'
    expect:
      value: "99914B932BD37A50B983C5E7C90AE93B"

  - name: value_hash_empty_list_ripemd160
    code: 'value_hash({}, "ripemd160")'
    expect:
      value: "85E318A2B32953EDE3405FF0B2914E96C6292464"

  - name: value_hash_empty_list_sha1
    code: 'value_hash({}, "sha1")'
    expect:
      value: "BF21A9E8FBC5A3846FB05B4FA0859E0917B2202F"

  - name: value_hash_empty_list_sha224
    code: 'value_hash({}, "sha224")'
    expect:
      value: "5CDD15A873608087BE07A41B7F1A04E96D3A66FE7A9B0FAAC71F8D05"

  - name: value_hash_empty_list_sha384
    code: 'value_hash({}, "sha384")'
    expect:
      value: "D2A23BC783E3AA38F401E13C7488505137C4954A7FD88331F1597C5FF71111DC807C7370A5B282C6DA541C56EDE69F30"

  - name: value_hash_empty_list_sha512
    code: 'value_hash({}, "sha512")'
    expect:
      value: "27C74670ADB75075FAD058D5CEAF7B20C4E7786C83BAE8A32F626F9782AF34C9A33C2046EF60FD2A7878D378E29FEC851806BBD9A67878F3A9F1CDA4830763FD"

  # Exact binary output for hash functions
  - name: string_hash_binary_output_exact_md5
    code: 'string_hash("", "md5", 1)'
    expect:
      value: "~D4~1D~8C~D9~8F~00~B2~04~E9~80~09~98~EC~F8~42~7E"

  - name: binary_hash_binary_output_exact_md5
    code: 'binary_hash("~00~00~00~00~00", "md5", 1)'
    expect:
      value: "~CA~9C~49~1A~C6~6B~2C~62~50~08~82~E9~3F~37~19~A8"

  - name: value_hash_binary_output_exact_md5
    code: 'value_hash([], "md5", 1)'
    expect:
      value: "~D7~51~71~39~88~98~7E~93~31~98~03~63~E2~41~89~CE"

  # Invalid algorithm names for binary_hash and value_hash
  - name: binary_hash_invalid_algorithm
    code: 'binary_hash("abc", "con")'
    expect:
      error: E_INVARG

  - name: value_hash_invalid_algorithm
    code: 'value_hash("abc", "carne")'
    expect:
      error: E_INVARG

  # HMAC - string_hmac
  - name: string_hmac_jefe_sha256
    code: 'string_hmac("what do ya want for nothing?", "Jefe", "sha256")'
    expect:
      value: "5BDCC146BF60754E6A042426089575C75A003F089D2739839DEC58B964EC3843"

  - name: string_hmac_jefe_sha256_default
    code: 'string_hmac("what do ya want for nothing?", "Jefe")'
    expect:
      value: "5BDCC146BF60754E6A042426089575C75A003F089D2739839DEC58B964EC3843"

  - name: string_hmac_empty_sha256
    code: 'string_hmac("", "")'
    expect:
      value: "B613679A0814D9EC772F95D778C35FC5FF1697C493715653C6C712144292C5AD"

  - name: string_hmac_jefe_sha1
    code: 'string_hmac("what do ya want for nothing?", "Jefe", "sha1")'
    expect:
      value: "EFFCDF6AE5EB2FA2D27416D5F184DF9C259A7C79"

  - name: string_hmac_invalid_algorithm
    code: 'string_hmac("abc", "abc", "bozo")'
    expect:
      error: E_INVARG

  # HMAC-SHA1 extended test vectors (Nettle reference)
  - name: string_hmac_hi_there_sha1
    code: 'string_hmac("Hi There", "~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b", "sha1")'
    expect:
      value: "B617318655057264E28BC0B6FB378C8EF146BE00"

  - name: string_hmac_truncation_sha1
    code: 'string_hmac("Test With Truncation", "~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c", "sha1")'
    expect:
      value: "4C1A03424B55E07FE7F27BE1D58BB9324A9A5A04"

  - name: string_hmac_large_key_first_sha1
    code: 'string_hmac("Test Using Larger Than Block-Size Key - Hash Key First", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha1")'
    expect:
      value: "AA4AE5E15272D00E95705637CE8A3B55ED402112"

  - name: string_hmac_large_key_and_data_sha1
    code: 'string_hmac("Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha1")'
    expect:
      value: "E8E99D0F45237D786D6BBAA7965C7808BBFF1A91"

  - name: string_hmac_empty_sha1
    code: 'string_hmac("", "", "sha1")'
    expect:
      value: "FBDB1D1B18AA6C08324B7D64B71FB76370690E1D"

  - name: string_hmac_key_with_nulls_sha1
    code: 'string_hmac("Test Using Key with nulls", "123456789~00123456789~00123456789~00", "sha1")'
    expect:
      value: "999D63DE9594FB320FA1B1D7CC6D3662FEC60AB1"

  - name: string_hmac_key_with_nulls_sha256
    code: 'string_hmac("Test Using Key with nulls", "123456789~00123456789~00123456789~00", "sha256")'
    expect:
      value: "44D1527E6295BF1055924DEBECC4499776903B9C37FF7D6519452230A7C30AF8"

  # HMAC-SHA256 extended test vectors (Nettle reference)
  - name: string_hmac_hi_there_sha256
    code: 'string_hmac("Hi There", "~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b", "sha256")'
    expect:
      value: "B0344C61D8DB38535CA8AFCEAF0BF12B881DC200C9833DA726E9376C2E32CFF7"

  - name: string_hmac_truncation_sha256
    code: 'string_hmac("Test With Truncation", "~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c~0c", "sha256")'
    expect:
      value: "A3B6167473100EE06E0C796C2955552BFA6F7C0A6A8AEF8B93F860AAB0CD20C5"

  - name: string_hmac_large_key_131_sha256
    code: 'string_hmac("Test Using Larger Than Block-Size Key - Hash Key First", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha256")'
    expect:
      value: "60E431591EE0B67F0D8A26AACBF5B77F8E0BC6213728C5140546040F0EE37F54"

  - name: string_hmac_large_key_and_large_data_131_sha256
    code: 'string_hmac("This is a test using a larger than block-size key and a larger than block-size data. The key needs to be hashed before being used by the HMAC algorithm.", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha256")'
    expect:
      value: "9B09FFA71B942FCB27635FBCD5B0E944BFDC63644F0713938A7F51535C3A35E2"

  # HMAC - binary_hmac
  - name: binary_hmac_jefe_sha1
    code: 'binary_hmac("what do ya want for nothing?", "Jefe", "sha1")'
    expect:
      value: "EFFCDF6AE5EB2FA2D27416D5F184DF9C259A7C79"

  - name: binary_hmac_hi_there_sha1
    code: 'binary_hmac("Hi There", "~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b~0b", "sha1")'
    expect:
      value: "B617318655057264E28BC0B6FB378C8EF146BE00"

  - name: binary_hmac_empty_sha256
    code: 'binary_hmac("", "", "sha256")'
    expect:
      value: "B613679A0814D9EC772F95D778C35FC5FF1697C493715653C6C712144292C5AD"

  - name: binary_hmac_bad_binary_string
    code: 'binary_hmac("~00~#!~00", "key")'
    expect:
      error: E_INVARG

  - name: binary_hmac_bad_key
    code: 'string_hmac("", "~00~#!~00")'
    expect:
      error: E_INVARG

  # binary_hmac - extended test vectors
  - name: binary_hmac_dd_data_sha1
    code: 'binary_hmac("~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha1")'
    expect:
      value: "125D7342B9AC11CD91A39AF48AA17B4F63F175D3"

  - name: binary_hmac_cd_data_sha1
    code: 'binary_hmac("~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd", "~01~02~03~04~05~06~07~08~09~0a~0b~0c~0d~0e~0f~10~11~12~13~14~15~16~17~18~19", "sha1")'
    expect:
      value: "4C9007F4026250C6BC8414F9BF50C86C2D7235DA"

  - name: binary_hmac_dd_data_sha256
    code: 'binary_hmac("~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd~dd", "~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa~aa", "sha256")'
    expect:
      value: "773EA91E36800E46854DB8EBD09181A72959098B3EF8C122D9635514CED565FE"

  - name: binary_hmac_cd_data_sha256
    code: 'binary_hmac("~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd~cd", "~01~02~03~04~05~06~07~08~09~0a~0b~0c~0d~0e~0f~10~11~12~13~14~15~16~17~18~19", "sha256")'
    expect:
      value: "82558A389A443C0EA4CC819899F2083A85F0FAA3E578F8077A2E3FF46729665B"

  - name: binary_hmac_key_with_nulls_sha1
    code: 'binary_hmac("Test Using Key with nulls", "123456789~00123456789~00123456789~00", "sha1")'
    expect:
      value: "999D63DE9594FB320FA1B1D7CC6D3662FEC60AB1"

  - name: binary_hmac_key_with_nulls_sha256
    code: 'binary_hmac("Test Using Key with nulls", "123456789~00123456789~00123456789~00", "sha256")'
    expect:
      value: "44D1527E6295BF1055924DEBECC4499776903B9C37FF7D6519452230A7C30AF8"

  - name: binary_hmac_empty_sha1
    code: 'binary_hmac("", "", "sha1")'
    expect:
      value: "FBDB1D1B18AA6C08324B7D64B71FB76370690E1D"

  - name: binary_hmac_bad_key_binary_string
    code: 'binary_hmac("", "~00~#!~00")'
    expect:
      error: E_INVARG

  # HMAC - value_hmac
  - name: value_hmac_jefe_sha1
    code: 'value_hmac("what do ya want for nothing?", "Jefe", "sha1")'
    expect:
      value: "28809E3D8CEA48FABEBA399A4AF2942AEBD89DE4"

  - name: value_hmac_jefe_sha256
    code: 'value_hmac("what do ya want for nothing?", "Jefe", "sha256")'
    expect:
      value: "6E5C2A18FEBCCACA669AC5F4415342714850E76BA86824A3371270E6DD69956F"

  - name: value_hmac_empty_sha256
    code: 'value_hmac("", "", "sha256")'
    expect:
      value: "140B47411F10521CC48851F43C9ABE73016E1D45627C8523D25CBF7FE64F8B03"

  # Invalid algorithm names for HMAC
  - name: binary_hmac_invalid_algorithm
    code: 'binary_hmac("abc", "abc", "con")'
    expect:
      error: E_INVARG

  - name: value_hmac_invalid_algorithm
    code: 'value_hmac("abc", "abc", "carne")'
    expect:
      error: E_INVARG

  # Bad binary key for HMAC
  - name: value_hmac_bad_key
    code: 'value_hmac("", "~00~#!~00")'
    expect:
      error: E_INVARG

  # Exact binary output for HMAC
  - name: string_hmac_binary_output_exact_sha256
    code: 'string_hmac("", "", "sha256", 1)'
    expect:
      value: "~B6~13~67~9A~08~14~D9~EC~77~2F~95~D7~78~C3~5F~C5~FF~16~97~C4~93~71~56~53~C6~C7~12~14~42~92~C5~AD"

  - name: binary_hmac_binary_output_exact_sha256
    code: 'binary_hmac("", "", "sha256", 1)'
    expect:
      value: "~B6~13~67~9A~08~14~D9~EC~77~2F~95~D7~78~C3~5F~C5~FF~16~97~C4~93~71~56~53~C6~C7~12~14~42~92~C5~AD"

  - name: value_hmac_binary_output_exact_sha256
    code: 'value_hmac("", "", "sha256", 1)'
    expect:
      value: "~14~0B~47~41~1F~10~52~1C~C4~88~51~F4~3C~9A~BE~73~01~6E~1D~45~62~7C~85~23~D2~5C~BF~7F~E6~4F~8B~03"

  # Hash case sensitivity
  - name: string_hash_case_insensitive_md5
    code: 'string_hash("abc", "md5") == string_hash("abc", "MD5")'
    expect:
      value: 1

  - name: binary_hash_case_insensitive_sha256
    code: 'binary_hash("abc", "sha256") == binary_hash("abc", "SHA256")'
    expect:
      value: 1

  - name: value_hash_case_insensitive_sha1
    code: 'value_hash("abc", "sha1") == value_hash("abc", "SHA1")'
    expect:
      value: 1

  # Binary string output
  # Note: Binary output uses ~XX escape encoding, so each byte = 3 characters
  # MD5: 16 bytes * 3 = 48, SHA1: 20 bytes * 3 = 60, SHA256: 32 bytes * 3 = 96
  - name: string_hash_binary_output_md5
    code: 'length(string_hash("abc", "md5", 1))'
    expect:
      value: 48

  - name: binary_hash_binary_output_sha256
    code: 'length(binary_hash("abc", "sha256", 1))'
    expect:
      value: 96

  - name: value_hash_binary_output_sha1
    code: 'length(value_hash("abc", "sha1", 1))'
    expect:
      value: 60

  - name: string_hmac_binary_output_sha256
    code: 'length(string_hmac("abc", "key", "sha256", 1))'
    expect:
      value: 96

  - name: binary_hmac_binary_output_sha1
    code: 'length(binary_hmac("abc", "key", "sha1", 1))'
    expect:
      value: 60

  - name: value_hmac_binary_output_sha256
    code: 'length(value_hmac("abc", "key", "sha256", 1))'
    expect:
      value: 96

  # Hash/HMAC lengths
  - name: hash_length_md5
    code: 'length(string_hash("", "md5"))'
    expect:
      value: 32

  - name: hash_length_sha1
    code: 'length(string_hash("", "sha1"))'
    expect:
      value: 40

  - name: hash_length_sha224
    code: 'length(string_hash("", "sha224"))'
    expect:
      value: 56

  - name: hash_length_sha256
    code: 'length(string_hash("", "sha256"))'
    expect:
      value: 64

  - name: hash_length_sha384
    code: 'length(string_hash("", "sha384"))'
    expect:
      value: 96

  - name: hash_length_sha512
    code: 'length(string_hash("", "sha512"))'
    expect:
      value: 128

  - name: hash_length_ripemd160
    code: 'length(string_hash("", "ripemd160"))'
    expect:
      value: 40

  # Salt generation - salt(prefix, random_data)
  - name: salt_standard_two_char
    code: 'salt("", "~00~00")'
    expect:
      value: ".."

  - name: salt_standard_requires_two_chars
    code: 'salt("", "")'
    expect:
      error: E_INVARG

  - name: salt_md5_prefix
    code: 'salt("$1$", "~00~00~00~00~00~00")'
    expect:
      value: "$1$........"

  - name: salt_md5_requires_three_chars
    code: 'salt("$1$", "12")'
    expect:
      error: E_INVARG

  - name: salt_sha256_prefix
    code: 'salt("$5$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      value: "$5$................"

  - name: salt_sha256_requires_three_chars
    code: 'salt("$5$", "~00~00")'
    expect:
      error: E_INVARG

  - name: salt_sha256_rounds
    code: 'salt("$5$rounds=10000$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      value: "$5$rounds=10000$................"

  - name: salt_sha256_rounds_min
    code: 'salt("$5$rounds=999$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      error: E_INVARG

  - name: salt_sha256_rounds_max
    code: 'salt("$5$rounds=1000000000$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      error: E_INVARG

  - name: salt_sha512_prefix
    code: 'salt("$6$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      value: "$6$................"

  - name: salt_sha512_requires_three_chars
    code: 'salt("$6$", "~00~00")'
    expect:
      error: E_INVARG

  - name: salt_sha512_rounds
    code: 'salt("$6$rounds=10000$", "~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      value: "$6$rounds=10000$................"

  - name: salt_bcrypt_prefix
    code: 'salt("$2a$", "~00~00~00~00~00~00~00~00~00~00~00~00~00~00~00~00")'
    expect:
      value: "$2a$05$......................"

  - name: salt_bcrypt_requires_sixteen_chars
    code: 'salt("$2a$", "1234567890")'
    expect:
      error: E_INVARG

  - name: salt_bcrypt_cost_factor
    code: 'salt("$2a$16$", "1234567890123456")'
    expect:
      value: "$2a$16$KRGxLBS0Lxe3KBCwKxOzLe"

  - name: salt_bcrypt_cost_min
    code: 'salt("$2a$03$", "1234567890123456")'
    expect:
      error: E_INVARG

  - name: salt_bcrypt_cost_max
    code: 'salt("$2a$32$", "1234567890123456")'
    expect:
      error: E_INVARG

  - name: salt_bad_binary_string
    code: 'salt("", "~00~#!")'
    expect:
      error: E_INVARG

  - name: salt_invalid_prefix
    code: 'salt("$99$", "abc")'
    expect:
      error: E_INVARG

  # Salt edge cases from Ruby tests
  - name: salt_bcrypt_cost_04
    code: 'salt("$2a$04$", "1234567890123456")'
    expect:
      value: "$2a$04$KRGxLBS0Lxe3KBCwKxOzLe"

  - name: salt_bcrypt_cost_max_above_31
    code: 'salt("$2a$41$", "1234567890123456")'
    expect:
      error: E_INVARG

  - name: salt_bcrypt_cost_empty
    code: 'salt("$2a$$", "1234567890123456")'
    expect:
      error: E_INVARG

  - name: salt_bcrypt_cost_alpha
    code: 'salt("$2a$mm$", "1234567890123456")'
    expect:
      error: E_INVARG

  - name: salt_standard_one_byte_too_few
    code: 'salt("", "~00")'
    expect:
      error: E_INVARG

  - name: salt_bcrypt_bad_binary_last_byte
    code: 'salt("$2a$", "~00~00~00~00~00~00~00~00~00~00~00~00~00~00~00~zz")'
    expect:
      error: E_INVARG

  - name: salt_invalid_prefix_foo
    code: 'salt("foo", "")'
    expect:
      error: E_INVARG

  # Crypt - Windows Toast only supports $2a$ bcrypt, not DES/SHA/SHA512/$2b$
  - name: crypt_one_arg_defaults_to_unix
    skip: "DES crypt not supported on Windows"
    code: 'length(crypt("password"))'
    expect:
      value: 13

  - name: crypt_falls_through_to_unix
    skip: "DES crypt not supported on Windows"
    code: 'length(crypt("password", "ab"))'
    expect:
      value: 13

  - name: crypt_sha256_with_salt
    skip: "SHA256 crypt not supported on Windows"
    code: 'index(crypt("password", "$5$abc"), "$5$")'
    expect:
      value: 1

  - name: crypt_sha256_rounds_wizard
    skip: "SHA256 crypt not supported on Windows"
    permission: wizard
    code: 'index(crypt("password", "$5$rounds=10000$abc"), "$5$rounds=10000$")'
    expect:
      value: 1

  - name: crypt_sha256_rounds_non_wizard
    skip: "SHA256 crypt not supported on Windows"
    permission: programmer
    code: 'index(crypt("password", "$5$rounds=10000$abc"), "$5$rounds=10000$")'
    expect:
      error: E_PERM

  - name: crypt_sha512_with_salt
    skip: "SHA512 crypt not supported on Windows"
    code: 'index(crypt("password", "$6$abc"), "$6$")'
    expect:
      value: 1

  - name: crypt_sha512_rounds_wizard
    skip: "SHA512 crypt not supported on Windows"
    permission: wizard
    code: 'index(crypt("password", "$6$rounds=10000$abc"), "$6$rounds=10000$")'
    expect:
      value: 1

  - name: crypt_sha512_rounds_non_wizard
    skip: "SHA512 crypt not supported on Windows"
    permission: programmer
    code: 'index(crypt("password", "$6$rounds=10000$abc"), "$6$rounds=10000$")'
    expect:
      error: E_PERM

  - name: crypt_bcrypt_2a_with_salt
    code: 'crypt("foobar", "$2a$05$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      value: "$2a$05$KRGxLBS0Lxe3KBCwKxOzLeMe5OhXhsCBVMLq7IYo9z2kiiCZMSmz6"

  - name: crypt_bcrypt_2a_requires_sixteen_chars
    code: 'crypt("foobar", "$2a$05$KRGxLBS0Lxe3KBCwKxOzL")'
    expect:
      error: E_INVARG

  - name: crypt_bcrypt_2a_cost_factor_wizard
    permission: wizard
    code: 'crypt("foobar", "$2a$14$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      value: "$2a$14$KRGxLBS0Lxe3KBCwKxOzLe7p.ddns6iDfgZCpWHCQ4hN.RUaeF9Rq"

  - name: crypt_bcrypt_2a_cost_min
    permission: wizard
    code: 'crypt("foobar", "$2a$03$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      error: E_INVARG

  - name: crypt_bcrypt_2a_cost_max
    permission: wizard
    code: 'crypt("foobar", "$2a$32$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      error: E_INVARG

  - name: crypt_bcrypt_2a_cost_non_five_requires_wizard
    permission: programmer
    code: 'crypt("foobar", "$2a$10$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      error: E_PERM

  - name: crypt_bcrypt_2a_cost_non_five_wizard_succeeds
    permission: wizard
    code: 'crypt("foobar", "$2a$10$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      value: "$2a$10$KRGxLBS0Lxe3KBCwKxOzLeAgxB7LpTJ36c2o2iVIDdBSv3rB.GHhW"

  - name: crypt_bcrypt_2a_invalid_cost_alpha
    permission: wizard
    code: 'crypt("foobar", "$2a$ab$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      error: E_INVARG

  - name: crypt_bcrypt_2a_invalid_cost_special
    permission: wizard
    code: 'crypt("foobar", "$2a$!!$KRGxLBS0Lxe3KBCwKxOzLe")'
    expect:
      error: E_INVARG

  - name: crypt_invalid_salt
    code: 'crypt("password", "$99$abc")'
    expect:
      error: E_INVARG
